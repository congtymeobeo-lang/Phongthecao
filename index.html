<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PhongCard Mini Game N√¢ng C·∫•p</title>
<style>
/* ===== Reset & Body ===== */
* {margin:0; padding:0; box-sizing:border-box;}
body {font-family: Arial, sans-serif; background:#f0f0f0; color:#333; transition: background 0.3s, color 0.3s;}
body.dark {background:#121212; color:#eee;}
a{text-decoration:none; color:inherit;}
button{cursor:pointer;}
header{padding:10px; text-align:center; font-size:1.5em; font-weight:bold;}

/* ===== Tabs ===== */
.tab{display:none; padding:15px; padding-bottom:80px; min-height:80vh;}
.tab.active{display:block;}
h2{margin-bottom:10px;}
button.action{padding:10px 20px; margin:5px 0; border:none; background:#2196F3; color:#fff; border-radius:5px; transition: transform 0.2s;}
button.action:hover{transform:scale(1.05);}
body.dark button.action{background:#0b79d0;}
input[type=text], input[type=password], input[type=number]{padding:10px; width:100%; margin:5px 0; border-radius:5px; border:1px solid #ccc;}
body.dark input[type=text], body.dark input[type=password], body.dark input[type=number]{background:#222; color:#eee; border:1px solid #555;}
table{width:100%; border-collapse: collapse; margin-top:10px;}
th, td{border:1px solid #ccc; padding:5px; text-align:center;}
body.dark table, body.dark th, body.dark td{border:1px solid #555;}
@keyframes fadeIn {from{opacity:0;} to{opacity:1;}}
.fade-in{animation:fadeIn 0.3s;}
.pixel {font-family: monospace; white-space: pre; font-size:12px;}
nav{position:fixed; bottom:0; left:0; width:100%; display:flex; justify-content:space-around; background:#fff; border-top:1px solid #ccc; transition: background 0.3s;}
body.dark nav{background:#1e1e1e; border-top:1px solid #444;}
nav button{flex:1; padding:10px; font-size:1em; border:none; background:none; transition: background 0.3s;}
nav button.active{background:#ddd;}
body.dark nav button.active{background:#333;}
#overlay {position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); display:none; justify-content:center; align-items:center; color:#fff; z-index:1000; flex-direction:column; text-align:center; padding:20px;}
#overlay button{margin-top:20px;}
#fish-area {position:relative; height:50px; background:#a0e0ff; margin:10px 0; overflow:hidden; border-radius:5px;}
#fish {position:absolute; left:0; top:0; font-size:24px;}
</style>
</head>
<body>

<header>PhongCard Mini Game N√¢ng C·∫•p</header>

<!-- ===== Tabs ===== -->
<div id="home" class="tab active">
  <h2>Trang ch·ªß</h2>
  <p>Xin ch√†o, <span id="user-name">Kh√°ch</span>!</p>
  <p>Coin: <span id="coin">0</span> | Pcoin: <span id="pcoin">0</span> | L∆∞·ª£t quay: <span id="spin-count">0</span></p>
  <button class="action" id="toggle-dark">Dark/Light Mode</button>
</div>

<div id="spin" class="tab">
  <h2>V√≤ng quay</h2>
  <p>Gi√° 1 l∆∞·ª£t: 1 l∆∞·ª£t quay</p>
  <button class="action" id="spin-btn">Quay</button>
  <p id="spin-result"></p>
  <pre id="spin-animation" class="pixel"></pre>
</div>

<div id="code" class="tab">
  <h2>Nh·∫≠p Giftcode</h2>
  <input type="text" id="giftcode" placeholder="Nh·∫≠p code t·ª´ PHONGCARD001 ƒë·∫øn PHONGCARD300 ho·∫∑c Adminphong">
  <button class="action" id="redeem-btn">Nh·∫≠n</button>
  <p id="gift-result"></p>
</div>

<div id="games" class="tab">
  <h2>Ki·∫øm ti·ªÅn</h2>
  <p>C√¢u c√° (5 Pcoin), Tung x√∫c x·∫Øc (3 Pcoin), K√©o b√≤ (15 Pcoin), N·ªëi t·ª´ (60 Pcoin/1 l∆∞·ª£t)</p>

  <h3>C√¢u c√°</h3>
  <div id="fish-area"><span id="fish">üêü</span></div>
  <button class="action" id="fish-btn">Gi·∫≠t c√°</button>
  <p id="game-result"></p>

  <h3>Tung x√∫c x·∫Øc</h3>
  <button class="action" id="dice-btn">Tung x√∫c x·∫Øc</button>

  <h3>K√©o b√≤</h3>
  <button class="action" id="cow-btn">K√©o b√≤ 2 gi√¢y</button>
  <p id="cow-result"></p>

  <h3>N·ªëi t·ª´</h3>
  <p>Ph√≠ ch∆°i: 60 Pcoin, m·ªói 40 l·∫ßn n·ªëi th√†nh c√¥ng +20 Pcoin</p>
  <p id="word-current">B·∫Øt ƒë·∫ßu t·ª´: </p>
  <input type="text" id="word-input" placeholder="Nh·∫≠p t·ª´ n·ªëi ti·∫øp">
  <button class="action" id="word-submit">G·ª≠i</button>
  <p id="word-result"></p>
  <p>S·ªë l·∫ßn n·ªëi: <span id="word-count">0</span></p>

  <h3>ƒê·ªïi Pcoin sang VNƒê</h3>
  <input type="number" id="exchange-amount" placeholder="Nh·∫≠p s·ªë Pcoin mu·ªën ƒë·ªïi">
  <button class="action" id="exchange-btn">ƒê·ªïi</button>
</div>

<div id="account" class="tab">
  <h2>T√†i kho·∫£n & L·ªãch s·ª≠</h2>
  <div id="auth-section">
    <input type="text" id="reg-user" placeholder="T√™n ƒëƒÉng nh·∫≠p">
    <input type="password" id="reg-pass" placeholder="M·∫≠t kh·∫©u">
    <button class="action" id="register-btn">ƒêƒÉng k√Ω</button>
    <hr>
    <input type="text" id="login-user" placeholder="T√™n ƒëƒÉng nh·∫≠p">
    <input type="password" id="login-pass" placeholder="M·∫≠t kh·∫©u">
    <button class="action" id="login-btn">ƒêƒÉng nh·∫≠p</button>
  </div>
  <div id="dash-section" style="display:none;">
    <button class="action" id="logout-btn">ƒêƒÉng xu·∫•t</button>
    <h3>L·ªãch s·ª≠</h3>
    <table id="history-table">
      <tr><th>Th·ªùi gian</th><th>S·ª± ki·ªán</th><th>Coin/Pcoin</th></tr>
    </table>
  </div>
</div>

<!-- ===== Menu ===== -->
<nav>
  <button class="active" data-tab="home">Trang ch·ªß</button>
  <button data-tab="spin">V√≤ng quay</button>
  <button data-tab="code">Code</button>
  <button data-tab="games">Ki·∫øm ti·ªÅn</button>
  <button data-tab="account">T√†i kho·∫£n</button>
</nav>

<!-- ===== Overlay ===== -->
<div id="overlay">
  <p id="overlay-text"></p>
  <button class="action" id="overlay-btn">ƒê√≥ng</button>
</div>

<audio id="ting-sound" src="https://freesound.org/data/previews/320/320181_5260877-lq.mp3"></audio>

<script>
// ===== LocalStorage Init =====
if(!localStorage.getItem('users')) localStorage.setItem('users', JSON.stringify({}));
let users = JSON.parse(localStorage.getItem('users'));
let currentUser = localStorage.getItem('currentUser') || null;

function updateDash(){
  if(currentUser){
    document.getElementById('auth-section').style.display='none';
    document.getElementById('dash-section').style.display='block';
    document.getElementById('user-name').innerText=currentUser;
    const u = users[currentUser];
    document.getElementById('coin').innerText = u.coin || 0;
    document.getElementById('pcoin').innerText = u.pcoin || 0;
    document.getElementById('spin-count').innerText = u.spinCount || 0;
    updateHistoryTable();
  } else {
    document.getElementById('auth-section').style.display='block';
    document.getElementById('dash-section').style.display='none';
  }
}

// ===== Tabs =====
const tabs = document.querySelectorAll('.tab');
const navButtons = document.querySelectorAll('nav button');
navButtons.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    navButtons.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    const target = btn.dataset.tab;
    tabs.forEach(t=>t.classList.remove('active'));
    document.getElementById(target).classList.add('active');
  });
});

// ===== Dark Mode =====
document.getElementById('toggle-dark').addEventListener('click', ()=>{
  document.body.classList.toggle('dark');
});

// ===== Auth =====
document.getElementById('register-btn').addEventListener('click', ()=>{
  const u=document.getElementById('reg-user').value.trim();
  const p=document.getElementById('reg-pass').value.trim();
  if(!u||!p){alert('Nh·∫≠p ƒë·∫ßy ƒë·ªß'); return;}
  if(users[u]){alert('T√†i kho·∫£n ƒë√£ t·ªìn t·∫°i'); return;}
  users[u]={coin:0,pcoin:0,spinCount:0,history:[],password:p};
  localStorage.setItem('users', JSON.stringify(users));
  alert('ƒêƒÉng k√Ω th√†nh c√¥ng!');
});
document.getElementById('login-btn').addEventListener('click', ()=>{
  const u=document.getElementById('login-user').value.trim();
  const p=document.getElementById('login-pass').value.trim();
  if(users[u] && users[u].password===p){
    currentUser=u;
    localStorage.setItem('currentUser', currentUser);
    updateDash();
  } else {alert('ƒêƒÉng nh·∫≠p th·∫•t b·∫°i');}
});
document.getElementById('logout-btn').addEventListener('click', ()=>{
  currentUser=null;
  localStorage.removeItem('currentUser
