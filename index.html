<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PhongCard â€” Gift Hub</title>
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#071026; --card:#0d1b2a; --muted:#9fb3c8; --accent:#6ee7b7; --accent2:#60a5fa;
    --glass: rgba(255,255,255,0.03);
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,Arial;background:
    radial-gradient(1200px 600px at 10% 10%, rgba(96,165,250,0.06), transparent 10%),
    radial-gradient(800px 500px at 90% 90%, rgba(110,231,183,0.04), transparent 10%),
    var(--bg); color:#e6f0f6; -webkit-font-smoothing:antialiased;}
  header{height:72px;display:flex;align-items:center;padding:0 18px;gap:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);backdrop-filter: blur(6px);border-bottom:1px solid rgba(255,255,255,0.02)}
  .logo{display:flex;align-items:center;gap:12px}
  .logo .icon{width:44px;height:44;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:700;color:#05263a}
  .logo h1{margin:0;font-size:18px}
  .sp {flex:1}
  /* nav */
  .nav {display:flex;align-items:center;gap:8px}
  .btn-ghost{background:none;border:0;padding:8px 12px;border-radius:10px;color:var(--muted);cursor:pointer}
  .btn-primary{background:linear-gradient(90deg,var(--accent),var(--accent2));border:0;padding:10px 14px;border-radius:10px;color:#04202b;cursor:pointer;font-weight:600}
  /* layout */
  .wrap{max-width:1100px;margin:26px auto;padding:12px;display:grid;grid-template-columns:1fr 360px;gap:20px}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:18px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 6px 24px rgba(2,6,23,0.6)}
  h2{margin:0 0 8px 0}
  p.muted{color:var(--muted);margin:6px 0 12px 0}
  input, select, textarea{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;margin-top:8px}
  .row{display:flex;gap:10px}
  .small{font-size:13px;color:var(--muted)}
  /* wheel */
  .wheel-wrap{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:12px}
  .wheel{width:320px;height:320px;border-radius:50%;position:relative;overflow:hidden;border:10px solid rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:center;transition:transform 4s cubic-bezier(.2,.9,.2,1)}
  .slice{position:absolute;width:50%;height:50%;left:50%;top:50%;transform-origin:0 0;display:flex;align-items:center;justify-content:center;font-weight:600}
  .pointer{position:absolute;top:-16px;left:50%;transform:translateX(-50%);width:0;height:0;border-left:18px solid transparent;border-right:18px solid transparent;border-bottom:28px solid var(--accent)}
  .spin-btn{padding:12px 18px;border-radius:12px;border:0;background:linear-gradient(90deg,var(--accent2),var(--accent));color:#02202a;font-weight:700;cursor:pointer}
  /* menu mobile */
  .hamburger{display:none}
  /* right column */
  .side .box{margin-bottom:12px}
  .history-list{max-height:360px;overflow:auto;padding:8px;background:rgba(0,0,0,0.12);border-radius:8px}
  .history-item{padding:8px;border-radius:8px;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);margin-bottom:8px}
  /* responsive */
  @media(max-width:980px){
    .wrap{grid-template-columns:1fr}
    .hamburger{display:block}
    .nav .hide-md{display:none}
  }
  /* nice micro-interactions */
  button:active{transform:translateY(1px)}
  .fade-in{animation:fadeIn .35s ease}
  @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
  /* small footer */
  footer{max-width:1100px;margin:18px auto;color:var(--muted);font-size:13px;text-align:center}
</style>
</head>
<body>
<header>
  <div class="logo">
    <div class="icon">P</div>
    <div>
      <h1>PhongCard Hub</h1>
      <div class="small">Giftcode â€” Quay thÆ°á»Ÿng â€” Admin ready</div>
    </div>
  </div>
  <div class="sp"></div>
  <div class="nav">
    <button class="btn-ghost hide-md" id="homeBtn">Home</button>
    <button class="btn-ghost hide-md" id="redeemBtn">Nháº­p giftcode</button>
    <button class="btn-ghost hide-md" id="wheelBtn">VÃ²ng quay</button>
    <button class="btn-ghost hide-md" id="historyBtn">Lá»‹ch sá»­</button>
    <button class="btn-primary" id="authBtn">ÄÄƒng nháº­p</button>
    <button class="hamburger btn-ghost" id="hambBtn">â˜°</button>
  </div>
</header>

<main class="wrap">
  <!-- left big column -->
  <section class="card fade-in" id="homePage">
    <h2>ChÃ o má»«ng tá»›i PhongCard</h2>
    <p class="muted">Nháº­p giftcode dáº¡ng <code>PHONGCARDXXX</code> (cÃ³ 30 code máº«u). Má»—i code cho 1 lÆ°á»£t quay. VÃ²ng quay cÃ³ tiá»n (2kâ€“7k), acc Blox Fruits, hoáº·c cÃ¢u chuyá»‡n.</p>

    <div style="display:flex;gap:12px;flex-wrap:wrap">
      <div style="flex:1;min-width:220px" class="card">
        <div class="small">TÃ i khoáº£n hiá»‡n táº¡i</div>
        <div id="userBox" style="margin-top:10px">ChÆ°a Ä‘Äƒng nháº­p</div>
      </div>

      <div style="min-width:220px" class="card">
        <div class="small">Sá»‘ lÆ°á»£t quay</div>
        <div id="spinCount" style="font-weight:700;font-size:18px;margin-top:8px">0</div>
      </div>
    </div>

    <hr style="opacity:0.06;margin:18px 0">

    <div id="codesSample" class="card">
      <div class="small">30 code máº«u (vÃ­ dá»¥) â€” paste 1 code vÃ o trang "Nháº­p giftcode":</div>
      <div style="display:flex;flex-wrap:wrap;gap:8px;margin-top:10px">
        <!-- codes inserted by JS -->
      </div>
    </div>

    <div style="margin-top:12px" class="card">
      <h3>HÆ°á»›ng dáº«n nhanh</h3>
      <ol class="small">
        <li>ÄÄƒng kÃ½ / Ä‘Äƒng nháº­p (nÃºt trÃªn gÃ³c pháº£i).</li>
        <li>VÃ o "Nháº­p giftcode" â†’ nháº­p 1 trong 30 code máº«u â†’ nháº­n 1 lÆ°á»£t quay.</li>
        <li>VÃ o "VÃ²ng quay" â†’ nháº¥n Quay Ä‘á»ƒ trÃºng thÆ°á»Ÿng.</li>
        <li>Xem lá»‹ch sá»­ pháº§n thÆ°á»Ÿng á»Ÿ má»¥c "Lá»‹ch sá»­".</li>
      </ol>
    </div>
  </section>

  <!-- right column -->
  <aside class="side">
    <div class="card box">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div class="small">Nháº­p giftcode</div>
          <div style="margin-top:8px;display:flex;gap:8px">
            <input id="giftInput" placeholder="VD: PHONGCARD001">
            <button class="btn-primary" id="redeemDo">Nháº­n</button>
          </div>
          <div id="redeemMsg" class="small" style="margin-top:8px;color:#cde"></div>
        </div>
      </div>
    </div>

    <div class="card box">
      <div class="small">VÃ²ng quay</div>
      <div class="wheel-wrap" style="margin-top:10px">
        <div class="pointer"></div>
        <div class="wheel" id="wheel">
          <!-- slices generated by JS -->
        </div>
        <button class="spin-btn" id="spinBtn">Quay ngay</button>
        <div id="spinMsg" class="small" style="margin-top:8px"></div>
      </div>
    </div>

    <div class="card box">
      <div class="small">Lá»‹ch sá»­ gáº§n Ä‘Ã¢y</div>
      <div class="history-list" id="historyBox">
        <!-- history items -->
      </div>
    </div>
  </aside>
</main>

<footer>
  PhiÃªn báº£n demo â€” Dá»¯ liá»‡u lÆ°u trÃªn trÃ¬nh duyá»‡t (LocalStorage). Admin page: <code>/admin.html</code> (user: <b>admin</b>, pass: <b>phong123</b>)
</footer>

<script>
/* ---------- DATA & STATE ---------- */
const STORAGE_KEY = 'phong_gift_v1';
let db = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');

/* ensure structures */
if (!db.users) db.users = {};       // users: { username: {pass, spins, history:[], usedCodes:[] } }
if (!db.codes) db.codes = [];       // available codes array
if (!db.accounts) db.accounts = []; // demo accounts (blox)
save();

/* create 30 sample codes only once */
if (db.codes.length === 0) {
  for(let i=1;i<=30;i++){
    const n = String(i).padStart(3,'0');
    db.codes.push('PHONGCARD' + n);
  }
  // add some demo Blox accounts
  db.accounts.push({name:'BF_Max_001',desc:'Max LV full Beli, demo'});
  db.accounts.push({name:'BF_Speedster',desc:'V4, CDK God (demo)'});
  save();
}

/* current session */
let currentUser = localStorage.getItem(STORAGE_KEY + '_session') || null;

/* ---------- UI refs ---------- */
const userBox = document.getElementById('userBox');
const spinCount = document.getElementById('spinCount');
const codesSampleWrap = document.querySelector('#codesSample > div');
const giftInput = document.getElementById('giftInput');
const redeemMsg = document.getElementById('redeemMsg');
const historyBox = document.getElementById('historyBox');
const wheelEl = document.getElementById('wheel');
const spinBtn = document.getElementById('spinBtn');
const spinMsg = document.getElementById('spinMsg');

/* menu buttons */
document.getElementById('homeBtn').addEventListener('click', ()=> scrollToTop());
document.getElementById('redeemBtn').addEventListener('click', ()=> focusGift());
document.getElementById('wheelBtn').addEventListener('click', ()=> scrollWheel());
document.getElementById('historyBtn').addEventListener('click', ()=> scrollHistory());

/* auth button */
document.getElementById('authBtn').addEventListener('click', ()=> openAuthModal());

/* redeem / spin handlers */
document.getElementById('redeemDo').addEventListener('click', redeemCode);
spinBtn.addEventListener('click', spinWheel);

/* render initial UI */
renderSamples();
renderUserState();
renderWheel();
renderHistory();

/* ---------- FUNCTIONS ---------- */

function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(db)); }
function saveSession(){ if(currentUser) localStorage.setItem(STORAGE_KEY + '_session', currentUser); else localStorage.removeItem(STORAGE_KEY + '_session'); }

function renderSamples(){
  const container = document.querySelector('#codesSample > div');
  container.innerHTML = ''; 
  db.codes.slice(0,30).forEach(c=>{
    const b = document.createElement('div');
    b.style.padding='6px 8px';
    b.style.borderRadius='8px';
    b.style.background='linear-gradient(180deg, rgba(255,255,255,0.01), transparent)';
    b.style.border='1px solid rgba(255,255,255,0.02)';
    b.style.cursor='pointer';
    b.style.fontSize='13px';
    b.innerText = c;
    b.addEventListener('click', ()=> { giftInput.value = c; });
    container.appendChild(b);
  });
}

function renderUserState(){
  if (currentUser && db.users[currentUser]) {
    userBox.innerHTML = `<div style="font-weight:700">${currentUser}</div><div class="small">ÄÄƒng nháº­p</div>`;
    spinCount.innerText = db.users[currentUser].spins || 0;
  } else {
    userBox.innerHTML = `<div class="small">ChÆ°a Ä‘Äƒng nháº­p</div><div style="margin-top:8px"><button class="btn-primary" onclick="openAuthModal()">ÄÄƒng nháº­p / ÄK</button></div>`;
    spinCount.innerText = '0';
  }
}

function openAuthModal(){
  // simple prompt modal -> register/login flows
  const action = prompt("Chá»n: 1 = ÄÄƒng kÃ½ má»›i, 2 = ÄÄƒng nháº­p, 3 = ÄÄƒng xuáº¥t (náº¿u Ä‘ang Ä‘Äƒng nháº­p)\nNháº­p 1/2/3:");
  if (!action) return;
  if (action === '1') {
    const u = prompt("TÃªn tÃ i khoáº£n (khÃ´ng dáº¥u, viáº¿t liá»n):");
    if (!u) return alert('Há»§y');
    if (db.users[u]) return alert('TÃ i khoáº£n tá»“n táº¡i!');
    const p = prompt("Máº­t kháº©u:");
    if (!p) return alert('Há»§y');
    db.users[u] = { pass: p, spins: 0, history: [], usedCodes: [] };
    save();
    alert('ÄÄƒng kÃ½ thÃ nh cÃ´ng! Báº¥m OK Ä‘á»ƒ Ä‘Äƒng nháº­p.');
    currentUser = u; saveSession(); renderUserState(); renderHistory();
  } else if (action === '2') {
    const u = prompt("TÃªn tÃ i khoáº£n:");
    if (!u) return;
    const p = prompt("Máº­t kháº©u:");
    if (!p) return;
    if (!db.users[u] || db.users[u].pass !== p) return alert('Sai thÃ´ng tin!');
    currentUser = u; saveSession(); renderUserState(); renderHistory();
    alert('ÄÄƒng nháº­p thÃ nh cÃ´ng: ' + u);
  } else if (action === '3') {
    if (!currentUser) return alert('Báº¡n chÆ°a Ä‘Äƒng nháº­p');
    if (!confirm('Báº¡n muá»‘n Ä‘Äƒng xuáº¥t?')) return;
    currentUser = null; saveSession(); renderUserState(); renderHistory();
    alert('ÄÃ£ Ä‘Äƒng xuáº¥t');
  } else alert('KhÃ´ng há»£p lá»‡');
}

/* Redeem code logic */
function redeemCode(){
  if (!currentUser || !db.users[currentUser]) return alert('HÃ£y Ä‘Äƒng nháº­p trÆ°á»›c!');
  const code = (giftInput.value || '').trim().toUpperCase();
  if (!code) return redeemMsg.innerText = 'Nháº­p code Ä‘Ã£ nhÃ©';
  const idx = db.codes.indexOf(code);
  if (idx === -1) {
    redeemMsg.innerText = 'âŒ Code khÃ´ng há»£p lá»‡ hoáº·c Ä‘Ã£ dÃ¹ng';
    return;
  }
  // mark used by user
  db.users[currentUser].spins = (db.users[currentUser].spins || 0) + 1;
  db.users[currentUser].usedCodes = db.users[currentUser].usedCodes || [];
  db.users[currentUser].usedCodes.push(code);
  // remove code globally so can't be reused
  db.codes.splice(idx,1);
  save();
  renderUserState();
  renderSamples();
  redeemMsg.innerText = `âœ… Nháº­n 1 lÆ°á»£t quay! Báº¡n cÃ³ ${db.users[currentUser].spins} lÆ°á»£t.`;
}

/* Wheel rendering + spin */
const wheelPrizes = [
  {type:'money', label:'2,000 VND', value:2000},
  {type:'money', label:'3,000 VND', value:3000},
  {type:'money', label:'5,000 VND', value:5000},
  {type:'money', label:'7,000 VND', value:7000},
  {type:'acc', label:'Acc Blox Fruit', value:0},
  {type:'story', label:'CÃ¢u chuyá»‡n: HÃ nh trÃ¬nh cá»§a Phong', value:0}
];

function renderWheel(){
  wheelEl.innerHTML = '';
  const colors = ['#065f46','#0ea5a4','#0284c7','#7c3aed','#d946ef','#f59e0b'];
  const sliceCount = wheelPrizes.length;
  for(let i=0;i<sliceCount;i++){
    const slice = document.createElement('div');
    slice.className = 'slice';
    const angle = 360/sliceCount * i;
    slice.style.transform = `rotate(${angle}deg) translate(-50%, -50%)`;
    slice.style.width = '60%';
    slice.style.height = '60%';
    slice.style.left = '50%';
    slice.style.top = '50%';
    slice.style.background = `conic-gradient(${colors[i % colors.length]} 0 100%)`;
    slice.style.clipPath = 'polygon(0 0, 100% 0, 0 100%)';
    slice.style.display = 'flex';
    slice.style.justifyContent = 'flex-start';
    slice.style.paddingLeft = '30%';
    slice.style.color = '#012';
    slice.style.fontWeight = '700';
    slice.innerHTML = `<div style="transform:rotate(${90 + (360/sliceCount)*0.5}deg);">${wheelPrizes[i].label}</div>`;
    wheelEl.appendChild(slice);
  }
}

/* spin handling */
let spinning = false;
function spinWheel(){
  if (!currentUser || !db.users[currentUser]) return alert('HÃ£y Ä‘Äƒng nháº­p trÆ°á»›c!');
  if (spinning) return;
  if ((db.users[currentUser].spins || 0) <= 0) return alert('Báº¡n chÆ°a cÃ³ lÆ°á»£t quay!');
  spinning = true;
  spinMsg.innerText = 'Äang quay...';
  // random pick prize
  const idx = Math.floor(Math.random() * wheelPrizes.length);
  // rotation: full spins + to target segment
  const single = 360 / wheelPrizes.length;
  const target = 360 * (4 + Math.random()*2) + (idx * single) + single/2;
  wheelEl.style.transition = 'transform 4s cubic-bezier(.2,.9,.2,1)';
  wheelEl.style.transform = `rotate(${target}deg)`;
  // reduce spin count
  db.users[currentUser].spins--;
  // after animation
  setTimeout(()=> {
    spinning = false;
    wheelEl.style.transition = '';
    // normalize transform (keep visual but reset rotation modulo 360)
    const finalDeg = target % 360;
    wheelEl.style.transform = `rotate(${finalDeg}deg)`;
    // award prize
    const prize = wheelPrizes[idx];
    let prizeText = '';
    if (prize.type === 'money') {
      prizeText = `Tiá»n ${prize.label}`;
    } else if (prize.type === 'acc') {
      // assign a demo account if available
      const acc = db.accounts.length ? db.accounts.shift() : {name:'AccDemo_Empty', desc:'(Háº¿t acc máº«u)'};
      prizeText = `Acc Blox Fruit: ${acc.name} â€” ${acc.desc}`;
    } else if (prize.type === 'story') {
      prizeText = `CÃ¢u chuyá»‡n: HÃ nh trÃ¬nh cá»§a Phong (demo)`;
    }
    // record
    db.users[currentUser].history = db.users[currentUser].history || [];
    const rec = { prize: prizeText, time: new Date().toLocaleString() };
    db.users[currentUser].history.unshift(rec);
    save();
    renderUserState();
    renderHistory();
    spinMsg.innerText = `ğŸ‰ Báº¡n nháº­n: ${prizeText}`;
  }, 4100);
}

/* history */
function renderHistory(){
  historyBox.innerHTML = '';
  if (!currentUser || !db.users[currentUser]) {
    historyBox.innerHTML = `<div class="small">ÄÄƒng nháº­p Ä‘á»ƒ xem lá»‹ch sá»­</div>`;
    return;
  }
  const list = db.users[currentUser].history || [];
  if (list.length === 0) {
    historyBox.innerHTML = `<div class="small">ChÆ°a cÃ³ pháº§n thÆ°á»Ÿng nÃ o</div>`;
    return;
  }
  list.slice(0,30).forEach(h=>{
    const div = document.createElement('div');
    div.className = 'history-item';
    div.innerHTML = `<div style="font-weight:700">${h.prize}</div><div class="small" style="margin-top:6px">${h.time}</div>`;
    historyBox.appendChild(div);
  });
}

/* nice helpers */
function scrollToTop(){ window.scrollTo({top:0,behavior:'smooth'}); }
function focusGift(){ document.getElementById('giftInput').focus(); }
function scrollWheel(){ const el = document.querySelector('.wheel-wrap'); if (el) el.scrollIntoView({behavior:'smooth'}); }
function scrollHistory(){ document.querySelector('#historyBox').scrollIntoView({behavior:'smooth'}); }

/* expose some functions for console/test */
window._PHONG = { db, save, current: ()=>currentUser, login: (u,p)=>{ if (db.users[u] && db.users[u].pass===p){ currentUser=u; saveSession(); renderUserState(); renderHistory(); return true } return false } }
</script>
</body>
</html>    <!-- ÄÄƒng nháº­p -->
    <section id="login" class="card">
      <h2>ÄÄƒng nháº­p / ÄÄƒng kÃ½</h2>
      <input type="text" id="username" placeholder="TÃªn tÃ i khoáº£n">
      <input type="password" id="password" placeholder="Máº­t kháº©u (náº¿u cÃ³)">
      <button onclick="login()">XÃ¡c nháº­n</button>
    </section>

    <!-- Nháº­p code -->
    <section id="gift" class="card hidden">
      <h2>Nháº­p Giftcode</h2>
      <input type="text" id="giftcode" placeholder="Nháº­p code...">
      <button onclick="redeemCode()">XÃ¡c nháº­n</button>
      <p id="giftMsg"></p>
    </section>

    <!-- VÃ²ng quay -->
    <section id="wheel" class="card hidden">
      <h2>VÃ²ng quay may máº¯n</h2>
      <div id="wheel">ğŸ¡</div>
      <button onclick="spinWheel()">Quay ngay</button>
      <p id="spinMsg"></p>
    </section>

    <!-- Lá»‹ch sá»­ -->
    <section id="history" class="card hidden">
      <h2>Lá»‹ch sá»­ nháº­n thÆ°á»Ÿng</h2>
      <div id="historyList"></div>
    </section>

    <!-- Admin -->
    <section id="admin" class="card hidden">
      <h2>Admin Dashboard</h2>
      <div id="adminPanel" class="hidden">
        <h3>Danh sÃ¡ch ngÆ°á»i chÆ¡i</h3>
        <table>
          <thead>
            <tr>
              <th>TÃ i khoáº£n</th>
              <th>LÆ°á»£t quay</th>
              <th>Code Ä‘Ã£ dÃ¹ng</th>
              <th>Lá»‹ch sá»­ thÆ°á»Ÿng</th>
            </tr>
          </thead>
          <tbody id="userTable"></tbody>
        </table>
      </div>
      <p id="adminMsg"></p>
    </section>
  </main>

  <script>
    // --- Giftcode list (30 code sáºµn) ---
    const giftcodes = [
      "PHONGCARD001","PHONGCARD002","PHONGCARD003","PHONGCARD004","PHONGCARD005",
      "PHONGCARD006","PHONGCARD007","PHONGCARD008","PHONGCARD009","PHONGCARD010",
      "PHONGCARD011","PHONGCARD012","PHONGCARD013","PHONGCARD014","PHONGCARD015",
      "PHONGCARD016","PHONGCARD017","PHONGCARD018","PHONGCARD019","PHONGCARD020",
      "PHONGCARD021","PHONGCARD022","PHONGCARD023","PHONGCARD024","PHONGCARD025",
      "PHONGCARD026","PHONGCARD027","PHONGCARD028","PHONGCARD029","PHONGCARD030"
    ];

    let currentUser = null;
    let isAdmin = false;
    let data = JSON.parse(localStorage.getItem("giftHub") || "{}");

    function saveData() {
      localStorage.setItem("giftHub", JSON.stringify(data));
    }

    function showPage(id) {
      document.querySelectorAll("main section").forEach(s => s.classList.add("hidden"));
      document.getElementById(id).classList.remove("hidden");
      if (id === "history") loadHistory();
      if (id === "admin" && isAdmin) loadAdmin();
    }

    // ÄÄƒng nháº­p
    function login() {
      const user = document.getElementById("username").value.trim();
      const pass = document.getElementById("password").value.trim();

      if (!user) return alert("Nháº­p tÃªn tÃ i khoáº£n!");

      // admin login
      if (user === "admin" && pass === "phong123") {
        currentUser = "admin";
        isAdmin = true;
        document.getElementById("adminMsg").innerText = "âœ… Admin Ä‘Äƒng nháº­p thÃ nh cÃ´ng!";
        document.getElementById("adminPanel").classList.remove("hidden");
        saveData();
        return;
      }

      currentUser = user;
      if (!data[user]) data[user] = { spins:0, history:[], usedCodes:[] };
      isAdmin = false;
      saveData();
      alert("Xin chÃ o, " + user + "!");
    }

    // Redeem code
    function redeemCode() {
      if (!currentUser || isAdmin) return alert("ÄÄƒng nháº­p báº±ng tÃ i khoáº£n thÆ°á»ng!");
      const code = document.getElementById("giftcode").value.trim().toUpperCase();
      if (!giftcodes.includes(code)) {
        document.getElementById("giftMsg").innerText = "âŒ Code khÃ´ng há»£p lá»‡!";
        return;
      }
      if (data[currentUser].usedCodes.includes(code)) {
        document.getElementById("giftMsg").innerText = "âš ï¸ Code nÃ y Ä‘Ã£ dÃ¹ng!";
        return;
      }
      data[currentUser].spins++;
      data[currentUser].usedCodes.push(code);
      saveData();
      document.getElementById("giftMsg").innerText = "âœ… Nháº­n thÃ nh cÃ´ng 1 lÆ°á»£t quay!";
    }

    // VÃ²ng quay
    function spinWheel() {
      if (!currentUser || isAdmin) return alert("ÄÄƒng nháº­p báº±ng tÃ i khoáº£n thÆ°á»ng!");
      if (data[currentUser].spins <= 0) {
        document.getElementById("spinMsg").innerText = "Báº¡n chÆ°a cÃ³ lÆ°á»£t quay!";
        return;
      }
      data[currentUser].spins--;

      const prizes = [
        "ğŸ’µ 2,000 VND", "ğŸ’µ 3,000 VND", "ğŸ’µ 5,000 VND", "ğŸ’µ 7,000 VND",
        "ğŸ® Acc Blox Fruit (Demo)", "ğŸ“– CÃ¢u chuyá»‡n: HÃ nh trÃ¬nh cá»§a Phong"
      ];
      const result = prizes[Math.floor(Math.random()*prizes.length)];
      document.getElementById("spinMsg").innerText = "ğŸ‰ Báº¡n nháº­n: " + result;
      data[currentUser].history.push({ prize: result, time: new Date().toLocaleString() });
      saveData();
    }

    // Lá»‹ch sá»­
    function loadHistory() {
      if (!currentUser || isAdmin) return;
      const list = document.getElementById("historyList");
      list.innerHTML = "";
      data[currentUser].history.forEach(h => {
        const div = document.createElement("div");
        div.className = "history-item";
        div.innerText = h.time + " â†’ " + h.prize;
        list.appendChild(div);
      });
    }

    // Admin dashboard
    function loadAdmin() {
      const table = document.getElementById("userTable");
      table.innerHTML = "";
      for (let user in data) {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${user}</td>
          <td>${data[user].spins}</td>
          <td>${data[user].usedCodes.join(", ") || "ChÆ°a dÃ¹ng"}</td>
          <td>
            ${data[user].history.map(h => h.time + " â†’ " + h.prize).join("<br>")}
          </td>
        `;
        table.appendChild(tr);
      }
    }
  </script>
</body>
                </html>
