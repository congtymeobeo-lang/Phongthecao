<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Phong Dashboard</title>
  <style>
    * {margin:0; padding:0; box-sizing:border-box; font-family:sans-serif;}
    body, html {height:100%; background:#111; color:#fff; overflow:hidden;}
    .hidden {display:none;}
    .center {display:flex; align-items:center; justify-content:center; height:100%; flex-direction:column;}

    /* Loading */
    #loading {position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;z-index:99;font-size:22px;}
    #loading.hidden {display:none;}

    /* Sections */
    section {position:absolute; top:0; left:0; right:0; bottom:60px; padding:20px; overflow-y:auto; display:none; animation:fade .4s;}
    section.active {display:block;}
    @keyframes fade {from{opacity:0;} to{opacity:1;}}

    /* Menu dưới */
    .navbar {position:fixed; bottom:0; left:0; right:0; height:60px; background:#222; display:flex; justify-content:space-around; align-items:center; border-top:2px solid #444;}
    .navbar button {background:none; border:none; color:#aaa; font-size:18px; flex:1; height:100%;}
    .navbar button.active {color:#0f0; border-top:3px solid #0f0;}

    /* Login */
    #login-section input {margin:6px 0; padding:8px; width:220px; border-radius:8px; border:none;}
    #login-section button {margin-top:10px; padding:8px 16px; border:none; border-radius:8px; background:#0f0; color:#000; cursor:pointer;}

    /* Home */
    #home {background:url('https://i.ibb.co/0m9P9t6/cat.jpg') center/cover no-repeat;}

    /* Giftcode */
    #giftcode input {padding:8px; border-radius:6px; border:none; margin-right:10px;}
    #giftcode button {padding:8px 14px; border:none; border-radius:6px; background:#0f0; color:#000;}
    .shake {animation:shake .3s;}
    @keyframes shake {0%{transform:translateX(0);}25%{transform:translateX(-5px);}50%{transform:translateX(5px);}75%{transform:translateX(-5px);}100%{transform:translateX(0);}}

    /* Quay */
    #wheel {width:250px;height:250px;border-radius:50%;border:8px solid #fff;position:relative;margin:20px auto;background:conic-gradient(#f00 0 60deg,#0f0 60deg 180deg,#00f 180deg 300deg,#ff0 300deg 360deg);}
    #pointer {width:0;height:0;border-left:15px solid transparent;border-right:15px solid transparent;border-bottom:30px solid #fff;position:absolute;top:-35px;left:calc(50% - 15px);}
    #spin-btn {padding:10px 20px;border:none;border-radius:10px;background:#0f0;color:#000;cursor:pointer;}
    #result {margin-top:15px;font-size:20px;}

    /* History */
    #history-list {list-style:none;padding:0;}
    #history-list li {background:#222;margin:6px 0;padding:10px;border-radius:8px;animation:fade .5s;}

    /* Account */
    #account p {margin:10px 0;}
    #logout-btn {padding:8px 16px;border:none;border-radius:8px;background:#f33;color:#fff;cursor:pointer;}

    /* Music button */
    #music-btn {position:fixed;top:10px;right:10px;padding:8px 12px;border:none;border-radius:20px;background:#0f0;color:#000;cursor:pointer;z-index:50;}
  </style>
</head>
<body>

<div id="loading">Loading...</div>

<!-- Login -->
<section id="login-section" class="center active">
  <h2>Đăng nhập / Đăng ký</h2>
  <input id="username" placeholder="Tài khoản">
  <input id="password" type="password" placeholder="Mật khẩu">
  <button onclick="login()">Vào Dashboard</button>
</section>

<!-- Home -->
<section id="home">
  <h1>Chào mừng bạn đến Dashboard 🐱</h1>
  <p>Đây là trang chủ với ảnh mèo dễ thương.</p>
</section>

<!-- Giftcode -->
<section id="giftcode">
  <h2>Nhập Giftcode</h2>
  <input id="code-input" placeholder="Nhập code">
  <button onclick="redeem()">Nhận</button>
  <p id="code-msg"></p>
</section>

<!-- Quay thưởng -->
<section id="spin">
  <h2>Quay thưởng</h2>
  <div id="wheel"><div id="pointer"></div></div>
  <button id="spin-btn" onclick="spin()">Quay</button>
  <div id="result"></div>
</section>

<!-- History -->
<section id="history">
  <h2>Lịch sử phần thưởng</h2>
  <ul id="history-list"></ul>
</section>

<!-- Account -->
<section id="account">
  <h2>Tài khoản</h2>
  <p id="account-name"></p>
  <button id="logout-btn" onclick="logout()">Đăng xuất</button>
</section>

<!-- Navbar -->
<div class="navbar hidden" id="navbar">
  <button onclick="showTab('home')" id="btn-home">🏠 Home</button>
  <button onclick="showTab('giftcode')" id="btn-gift">🎁 Code</button>
  <button onclick="showTab('spin')" id="btn-spin">🎡 Quay</button>
  <button onclick="showTab('history')" id="btn-history">📜 Lịch sử</button>
  <button onclick="showTab('account')" id="btn-account">👤 TK</button>
</div>

<!-- Music -->
<audio id="bg-music" loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_7b65e8c3f2.mp3" type="audio/mpeg">
</audio>
<button id="music-btn" onclick="toggleMusic()">🎶 Bật nhạc</button>

<script>
let currentUser = null;
let spinning = false;

function login(){
  const u=document.getElementById('username').value;
  const p=document.getElementById('password').value;
  if(!u||!p){alert("Nhập đủ tài khoản và mật khẩu!");return;}
  localStorage.setItem('user',u);
  currentUser=u;
  document.getElementById('account-name').innerText="Xin chào, "+u;
  document.getElementById('login-section').style.display="none";
  document.getElementById('navbar').classList.remove('hidden');
  showTab('home');
}

function logout(){
  localStorage.removeItem('user');
  currentUser=null;
  location.reload();
}

window.onload=function(){
  const u=localStorage.getItem('user');
  if(u){currentUser=u;
    document.getElementById('login-section').style.display="none";
    document.getElementById('navbar').classList.remove('hidden');
    document.getElementById('account-name').innerText="Xin chào, "+u;
    showTab('home');
  }
}

function showTab(id){
  document.getElementById('loading').classList.remove('hidden');
  setTimeout(()=>{
    document.getElementById('loading').classList.add('hidden');
    document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.querySelectorAll('.navbar button').forEach(b=>b.classList.remove('active'));
    document.getElementById('btn-'+id).classList.add('active');
  },400);
}

/* Giftcode */
const codes=["Phongcard1","Phongcard2","Phongcard3"];
function redeem(){
  const val=document.getElementById('code-input').value;
  const msg=document.getElementById('code-msg');
  if(codes.includes(val)){
    msg.innerText="Code hợp lệ! Bạn được +1 lượt quay.";
    msg.style.color="#0f0";
  }else{
    msg.innerText="Code sai!";
    msg.style.color="#f00";
    document.getElementById('code-input').classList.add('shake');
    setTimeout(()=>document.getElementById('code-input').classList.remove('shake'),300);
  }
}

/* Spin */
function spin(){
  if(spinning) return;
  spinning=true;
  const wheel=document.getElementById('wheel');
  const deg=360*5+Math.floor(Math.random()*360);
  wheel.style.transition="transform 3s ease-out";
  wheel.style.transform="rotate("+deg+"deg)";
  setTimeout(()=>{
    spinning=false;
    const result=["7K","5K","2K","Câu chuyện"];
    const r=result[Math.floor(Math.random()*result.length)];
    document.getElementById('result').innerText="Bạn trúng: "+r;
    addHistory(r);
  },3000);
}

/* History */
function addHistory(prize){
  let list=JSON.parse(localStorage.getItem('history_'+currentUser)||"[]");
  list.push({item:prize,time:new Date().toLocaleString()});
  localStorage.setItem('history_'+currentUser,JSON.stringify(list));
  renderHistory();
}
function renderHistory(){
  const list=JSON.parse(localStorage.getItem('history_'+currentUser)||"[]");
  const ul=document.getElementById('history-list');
  ul.innerHTML="";
  list.forEach(h=>{
    const li=document.createElement('li');
    li.innerText=h.time+" → "+h.item;
    ul.appendChild(li);
  });
}
renderHistory();

/* Music */
const music=document.getElementById("bg-music");
const btn=document.getElementById("music-btn");
function toggleMusic(){
  if(music.paused){music.play();btn.innerText="🔇 Tắt nhạc";}
  else{music.pause();btn.innerText="🎶 Bật nhạc";}
}
</script>
</body>
</html>
